{"ast":null,"code":"/*jslint sloppy:true indent:2 plusplus:true regexp:true*/\nvar contentPattern = '&&<>&&';\n\nfunction contentFor(contentName) {\n  return contentPattern + contentName + contentPattern;\n}\n\nfunction parseContents(locals) {\n  var name,\n      i = 1,\n      str = locals.body,\n      regex = new RegExp('\\n?' + contentPattern + '.+?' + contentPattern + '\\n?', 'g'),\n      split = str.split(regex),\n      matches = str.match(regex);\n  locals.body = split[0];\n\n  if (matches !== null) {\n    matches.forEach(function (match) {\n      name = match.split(contentPattern)[1];\n      locals[name] = split[i];\n      i++;\n    });\n  }\n}\n\nfunction parseScripts(locals) {\n  var str = locals.body,\n      regex = /\\<script[\\s\\S]*?\\>[\\s\\S]*?\\<\\/script\\>/g;\n\n  if (regex.test(str)) {\n    locals.body = str.replace(regex, '');\n    locals.script = str.match(regex).join('\\n');\n  }\n}\n\nfunction parseStyles(locals) {\n  var str = locals.body,\n      regex = /(?:\\<style[\\s\\S]*?\\>[\\s\\S]*?\\<\\/style\\>)|(?:\\<link[\\s\\S]*?\\>(?:\\<\\/link\\>)?)/g;\n\n  if (regex.test(str)) {\n    locals.body = str.replace(regex, '');\n    locals.style = str.match(regex).join('\\n');\n  }\n}\n\nfunction parseMetas(locals) {\n  var str = locals.body,\n      regex = /\\<meta[\\s\\S]*?\\>/g;\n\n  if (regex.test(str)) {\n    locals.body = str.replace(regex, '');\n    locals.meta = str.match(regex).join('\\n');\n  }\n}\n\nmodule.exports = function (req, res, next) {\n  if (!res.__render) res.__render = res.render;\n\n  res.render = function (view, options, fn) {\n    var layout,\n        self = this,\n        app = req.app,\n        defaultLayout = app.get('layout');\n    options = options || {};\n\n    if (typeof options === 'function') {\n      fn = options;\n      options = {};\n    }\n\n    if (options.layout === false || (options.layout || defaultLayout) === false) {\n      res.__render.call(res, view, options, fn);\n\n      return;\n    }\n\n    layout = options.layout || res.locals.layout || defaultLayout;\n\n    if (layout === true || layout === undefined) {\n      layout = 'layout';\n    }\n\n    options.contentFor = contentFor;\n\n    res.__render.call(res, view, options, function (err, str) {\n      var l, locals;\n\n      if (err) {\n        return fn ? fn(err) : next(err);\n      }\n\n      locals = {\n        body: str,\n        defineContent: function (contentName) {\n          return locals[contentName] || '';\n        }\n      };\n\n      for (l in options) {\n        if (options.hasOwnProperty(l) && l !== 'layout' && l !== 'contentFor') {\n          locals[l] = options[l];\n        }\n      }\n\n      if (typeof locals.body !== 'string') {\n        res.__render.call(self, view, locals, fn);\n\n        return;\n      }\n\n      if (options.extractScripts === true || options.extractScripts === undefined && app.get('layout extractScripts') === true) {\n        locals.script = '';\n        parseScripts(locals);\n      }\n\n      if (options.extractStyles === true || options.extractStyles === undefined && app.get('layout extractStyles') === true) {\n        locals.style = '';\n        parseStyles(locals);\n      }\n\n      if (options.extractMetas === true || options.extractMetas === undefined && app.get('layout extractMetas') === true) {\n        locals.meta = '';\n        parseMetas(locals);\n      }\n\n      parseContents(locals);\n\n      res.__render.call(self, layout, locals, fn);\n    });\n  };\n\n  next();\n};","map":{"version":3,"sources":["D:/Project Coding/node_modules/express-ejs-layouts/lib/express-layouts.js"],"names":["contentPattern","contentFor","contentName","parseContents","locals","name","i","str","body","regex","RegExp","split","matches","match","forEach","parseScripts","test","replace","script","join","parseStyles","style","parseMetas","meta","module","exports","req","res","next","__render","render","view","options","fn","layout","self","app","defaultLayout","get","call","undefined","err","l","defineContent","hasOwnProperty","extractScripts","extractStyles","extractMetas"],"mappings":"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","sourcesContent":["/*jslint sloppy:true indent:2 plusplus:true regexp:true*/\n\nvar contentPattern = '&&<>&&';\n\nfunction contentFor(contentName) {\n  return contentPattern + contentName + contentPattern;\n}\n\nfunction parseContents(locals) {\n  var name, i = 1, str = locals.body,\n    regex = new RegExp('\\n?' + contentPattern + '.+?' + contentPattern + '\\n?', 'g'),\n    split = str.split(regex),\n    matches = str.match(regex);\n\n  locals.body = split[0];\n\n  if (matches !== null) {\n    matches.forEach(function (match) {\n      name = match.split(contentPattern)[1];\n      locals[name] = split[i];\n      i++;\n    });\n  }\n}\n\nfunction parseScripts(locals) {\n  var str = locals.body, regex = /\\<script[\\s\\S]*?\\>[\\s\\S]*?\\<\\/script\\>/g;\n\n  if (regex.test(str)) {\n    locals.body = str.replace(regex, '');\n    locals.script = str.match(regex).join('\\n');\n  }\n}\n\nfunction parseStyles(locals) {\n  var str = locals.body, regex = /(?:\\<style[\\s\\S]*?\\>[\\s\\S]*?\\<\\/style\\>)|(?:\\<link[\\s\\S]*?\\>(?:\\<\\/link\\>)?)/g;\n\n  if (regex.test(str)) {\n    locals.body = str.replace(regex, '');\n    locals.style = str.match(regex).join('\\n');\n  }\n}\n\nfunction parseMetas(locals) {\n  var str = locals.body, regex = /\\<meta[\\s\\S]*?\\>/g;\n\n  if (regex.test(str)) {\n    locals.body = str.replace(regex, '');\n    locals.meta = str.match(regex).join('\\n');\n  }\n}\n\nmodule.exports = function (req, res, next) {\n  if(!res.__render) res.__render = res.render;\n\n  res.render = function (view, options, fn) {\n    var layout, self = this, app = req.app,\n      defaultLayout = app.get('layout');\n\n    options = options || {};\n    if (typeof options === 'function') {\n      fn = options;\n      options = {};\n    }\n\n    if (options.layout === false || ((options.layout || defaultLayout) === false)) {\n      res.__render.call(res, view, options, fn);\n      return;\n    }\n\n    layout = options.layout || res.locals.layout || defaultLayout;\n    if (layout === true || layout === undefined) {\n      layout = 'layout';\n    }\n\n    options.contentFor = contentFor;\n    res.__render.call(res, view, options, function (err, str) {\n      var l, locals;\n\n      if (err) { return fn ? fn(err) : next(err); }\n\n      locals = {\n        body: str,\n        defineContent: function(contentName) { return locals[contentName] || ''; }\n      };\n      for (l in options) {\n        if (options.hasOwnProperty(l) && l !== 'layout' && l !== 'contentFor') {\n          locals[l] = options[l];\n        }\n      }\n\n      if (typeof locals.body !== 'string') {\n        res.__render.call(self, view, locals, fn);\n        return;\n      }\n\n      if (options.extractScripts === true || (options.extractScripts === undefined && app.get('layout extractScripts') === true)) {\n        locals.script = '';\n        parseScripts(locals);\n      }\n\n      if (options.extractStyles === true || (options.extractStyles === undefined && app.get('layout extractStyles') === true)) {\n        locals.style = '';\n        parseStyles(locals);\n      }\n\n      if (options.extractMetas === true || (options.extractMetas === undefined && app.get('layout extractMetas') === true)) {\n        locals.meta = '';\n        parseMetas(locals);\n      }\n\n      parseContents(locals);\n      res.__render.call(self, layout, locals, fn);\n    });\n  };\n  next();\n};\n"]},"metadata":{},"sourceType":"script"}